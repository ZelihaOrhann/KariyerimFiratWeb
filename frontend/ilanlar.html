<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Ä°lanlar</title>
  <script src="https://cdn.tailwindcss.com"></script>
  
  <!-- Firebase SDK -->
  <script src="https://www.gstatic.com/firebasejs/10.8.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.8.0/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore-compat.js"></script>
  
  <!-- Firebase Config -->
  <script src="firebase-config.js"></script>
</head>
<body class="bg-gradient-to-br from-gray-900 to-gray-800 min-h-screen text-white flex flex-col">
  <header class="bg-gray-800 shadow-lg">
    <div class="container mx-auto px-4 py-4 flex justify-between items-center">
      <h1 class="text-2xl font-bold">Ä°ÅŸ ve Staj Ä°lanlarÄ±</h1>
      <!-- Avatar menÃ¼ burada olacak, ayrÄ± ekleniyor -->
    </div>
  </header>

  <main class="container mx-auto px-4 py-8 flex-1">
    <div class="pb-4">
      <div class="flex justify-center gap-6" id="ilanlarContainer"></div>
      <!-- Carousel Dots -->
      <div class="flex justify-center mt-6 gap-2" id="carouselDots"></div>
    </div>
  </main>

  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-app.js";
    import { getAuth, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js";
    import { getFirestore, doc, getDoc } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js";
    import { firebaseConfig } from './firebase-config.js';

    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);
    const db = getFirestore(app);

    // Dropdown menÃ¼ aÃ§/kapat
    const avatarBtn = document.getElementById('avatarBtn');
    const dropdownMenu = document.getElementById('dropdownMenu');
    avatarBtn.addEventListener('click', (e) => {
      e.stopPropagation();
      dropdownMenu.classList.toggle('hidden');
    });
    // SayfanÄ±n baÅŸka yerine tÄ±klanÄ±nca menÃ¼yÃ¼ kapat
    document.addEventListener('click', (e) => {
      if (!avatarBtn.contains(e.target)) {
        dropdownMenu.classList.add('hidden');
      }
    });

    // Ã‡Ä±kÄ±ÅŸ iÅŸlemi
    document.getElementById('logoutBtn').addEventListener('click', () => {
      signOut(auth).then(() => {
        window.location.href = "anasayfa.html";
      }).catch((error) => {
        console.error("Ã‡Ä±kÄ±ÅŸ yapÄ±lÄ±rken hata oluÅŸtu:", error);
      });
    });

    // Profili DÃ¼zenle ve Ayarlar butonlarÄ±
    document.getElementById('editProfileBtn').addEventListener('click', () => {
      window.location.href = "profil.html";
    });
    document.getElementById('settingsBtn').addEventListener('click', () => {
      window.location.href = "ayarlar.html";
    });

    // KullanÄ±cÄ± adÄ± ve avatarÄ± doldur
    onAuthStateChanged(auth, async (user) => {
      if (user) {
        try {
          const userDoc = await getDoc(doc(db, "users", user.uid));
          let adSoyad = user.displayName || user.email;
          if (userDoc.exists()) {
            const userData = userDoc.data();
            const ad = userData.ad || '';
            const soyad = userData.soyad || '';
            adSoyad = (ad + ' ' + soyad).trim() || adSoyad;
            document.getElementById('userAvatar').src = `https://ui-avatars.com/api/?name=${encodeURIComponent(adSoyad)}&background=FACC15&color=111827&size=64`;
          }
        } catch (error) {
          console.error("KullanÄ±cÄ± bilgileri alÄ±namadÄ±:", error);
        }
      } else {
        window.location.href = "anasayfa.html";
      }
    });
  </script>

  <!-- Navigation Script -->
  <script src="js/navigation.js"></script>
  <script src="js/avatarMenu.js"></script>

  <script>
    // Rastgele Ã¶rnek ilanlar
    const ilanlar = [
      {
        img: "https://kariyer.enter.enerjisa.com.tr/assets/images/enerjisa-enter.jpg",
        logo: "https://upload.wikimedia.org/wikipedia/commons/6/6a/Enerjisa_logo.png",
        sirket: "Enerjisa Enerji",
        baslik: "ENTER GenÃ§ Yetenek ProgramÄ± 2025",
        aciklama: "ENTER, Enerjisa DaÄŸÄ±tÄ±m bÃ¶lgemizde yer alan Ã¼niversitelerin ilgili bÃ¶lÃ¼mlerinde...",
        maas: true
      },
      {
        img: "https://www.eurekosigorta.com.tr/media/4v1j2v5n/future-generation.jpg",
        logo: "https://www.eurekosigorta.com.tr/favicon.ico",
        sirket: "Eureko Sigorta",
        baslik: "Future Generation Long -Term Career",
        aciklama: "Ready to start a journey full of growth and inspiration? If your answer is 'yes',...",
        maas: true
      },
      {
        img: "https://workintech.com.tr/assets/images/hero-img.png",
        logo: "https://workintech.com.tr/assets/images/logo.png",
        sirket: "Workintech",
        baslik: "Workintech YazÄ±lÄ±mcÄ± YetiÅŸtirme ProgramÄ±",
        aciklama: "Workintech ile 6 Ayda YazÄ±lÄ±mcÄ± Olup Ä°ÅŸe Girme FÄ±rsatÄ±. Workintech, Ä°ÅŸ BankasÄ± - Y...",
        maas: true
      },
      {
        img: "https://cdn.pixabay.com/photo/2016/11/29/09/32/architecture-1868667_1280.jpg",
        logo: "https://cdn-icons-png.flaticon.com/512/190/190411.png",
        sirket: "MimarlÄ±k Ofisi",
        baslik: "Mimari Proje Stajyeri",
        aciklama: "YaratÄ±cÄ± ve Ã¶ÄŸrenmeye aÃ§Ä±k stajyer mimar arÄ±yoruz.",
        maas: false
      },
      {
        img: "https://cdn.pixabay.com/photo/2015/09/18/19/03/africa-942362_1280.jpg",
        logo: "https://cdn-icons-png.flaticon.com/512/190/190406.png",
        sirket: "DoÄŸa Koruma",
        baslik: "Saha AsistanÄ± (Yaz DÃ¶nemi)",
        aciklama: "DoÄŸa projelerinde saha asistanÄ± olarak gÃ¶rev alacak gÃ¶nÃ¼llÃ¼ler arÄ±yoruz.",
        maas: false
      },
      {
        img: "https://cdn.pixabay.com/photo/2017/01/20/00/30/mountains-1993642_1280.jpg",
        logo: "https://cdn-icons-png.flaticon.com/512/190/190420.png",
        sirket: "OutdoorTech",
        baslik: "Kamp EkipmanlarÄ± SatÄ±ÅŸ DanÄ±ÅŸmanÄ±",
        aciklama: "Outdoor Ã¼rÃ¼nlerinde satÄ±ÅŸ ve mÃ¼ÅŸteri iliÅŸkileri iÃ§in takÄ±m arkadaÅŸÄ± arÄ±yoruz.",
        maas: true
      },
      {
        img: "https://cdn.pixabay.com/photo/2016/03/27/22/16/architecture-1287207_1280.jpg",
        logo: "https://cdn-icons-png.flaticon.com/512/190/190423.png",
        sirket: "YapÄ± Merkezi",
        baslik: "Ä°nÅŸaat MÃ¼hendisi (Yeni Mezun)",
        aciklama: "BÃ¼yÃ¼k Ã¶lÃ§ekli projelerde Ã§alÄ±ÅŸacak yeni mezun mÃ¼hendisler arÄ±yoruz.",
        maas: true
      },
      {
        img: "https://cdn.pixabay.com/photo/2016/11/29/03/53/adult-1867889_1280.jpg",
        logo: "https://cdn-icons-png.flaticon.com/512/190/190422.png",
        sirket: "SaÄŸlÄ±kNet",
        baslik: "SaÄŸlÄ±k DanÄ±ÅŸmanÄ±",
        aciklama: "SaÄŸlÄ±k sektÃ¶rÃ¼nde danÄ±ÅŸmanlÄ±k yapmak isteyen adaylar baÅŸvurabilir.",
        maas: false
      },
      {
        img: "https://cdn.pixabay.com/photo/2016/11/29/09/08/animal-1868911_1280.jpg",
        logo: "https://cdn-icons-png.flaticon.com/512/190/190421.png",
        sirket: "PetCare",
        baslik: "Veteriner Teknikeri",
        aciklama: "Hayvan saÄŸlÄ±ÄŸÄ± ve bakÄ±mÄ± konusunda deneyimli tekniker arÄ±yoruz.",
        maas: true
      }
    ];
    const ilanlarContainer = document.getElementById('ilanlarContainer');
    const dotsContainer = document.getElementById('carouselDots');
    const ilanlarScroll = document.getElementById('ilanlarScroll');
    const ilanPerPage = 3;
    const pageCount = Math.ceil(ilanlar.length / ilanPerPage);
    let activePage = 0;

    function renderIlanlar(page) {
      ilanlarContainer.innerHTML = '';
      const start = page * ilanPerPage;
      const end = Math.min(start + ilanPerPage, ilanlar.length);
      for (let i = start; i < end; i++) {
        const ilan = ilanlar[i];
        const card = document.createElement('div');
        card.className = "bg-gray-800 rounded-xl shadow-lg p-6 min-w-[320px] max-w-xs flex flex-col justify-between";
        card.innerHTML = `
          <img src="${ilan.img}" alt="${ilan.sirket}" class="rounded-lg mb-4 w-full h-40 object-cover" />
          <div class="flex items-center gap-2 mb-2">
            <img src="${ilan.logo}" alt="${ilan.sirket}" class="w-8 h-8 rounded-full" />
            <span class="text-gray-300 font-semibold">${ilan.sirket}</span>
          </div>
          <h2 class="text-lg font-bold mb-1">${ilan.baslik}</h2>
          <div class="text-gray-400 mb-2 text-sm">${ilan.aciklama}</div>
          <div class="flex items-center gap-2 text-xs text-gray-400 mb-2"><span>ğŸ’¼</span> ${ilan.maas ? 'MaaÅŸlÄ±' : 'GÃ¶nÃ¼llÃ¼'}</div>
          <button class="bg-yellow-400 text-gray-900 px-4 py-2 rounded hover:bg-yellow-300 font-semibold">BaÅŸvur</button>
        `;
        ilanlarContainer.appendChild(card);
      }
    }

    function updateDots(page) {
      dotsContainer.innerHTML = '';
      for (let i = 0; i < pageCount; i++) {
        const dot = document.createElement('button');
        dot.className = 'w-3 h-3 rounded-full ' + (i === page ? 'bg-blue-500' : 'bg-blue-200') + ' focus:outline-none';
        dot.addEventListener('click', () => {
          activePage = i;
          renderIlanlar(activePage);
          updateDots(activePage);
        });
        dotsContainer.appendChild(dot);
      }
    }

    // Ä°lk baÅŸta render et
    renderIlanlar(activePage);
    updateDots(activePage);
  </script>
</body>
</html>
